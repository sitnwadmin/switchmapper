**************************************************************************************
Name: SwitchPortMapper.py
Author: Joel Jordan
Date: 2/25/2020
Modified: 9/30/2020

Requirements: 
					  In order to run the script on a computer you must have the following installed:
					  1. Python 3.6
					  2. Python modules
						 - pandas (transforms data structures into structured data)
						 - netmiko (module to connect to network devices via SSH)
					  3. NTC Templates (transform unstructured show command output into structured python objects)
						 - git clone https://github.com/johnarnold/ntc-templates
						 - The script is hard-coded to point to the c:\ntc-templates directory

Description:  
					  This script is designed to run on Cisco Catalyst IOS switches and it
					  will perform the show commands and retrieve the following information
					  from the switch:
					  1. Port Connectivity Counts
					  2. CDP Neighbor information
					  3. Identifies possible rouge ports (ports with more than 3 MACs)
					  4. Displays connected and down interfaces
					  5. Displays disabled interfaces
					  6. Displays interfaces with no activity
					  7. Displays active interfaces with input/output errors
					  
					  The output will be an html file with the naming convention <site_code>_month_day_year_timeepoch.html

Usage:
					  switchportmapper.py <filename>
					  - <filename> - Name of the file that contains the IP address list the 
									 script will use. This file name must be within the
									 input_files folder under the folder of the site_code name.
									 You must create the folder and file manually or the script
									 will not complete.

Inputs: 	  
					  The script will ask the user for the following inputs:
					  1. Username - This is the username you want to use to authenticate to the 
						 switch
					  2. Password - The password used for authentication.  Uses the getpass 
						 module so your password is not stored in plaintext
					  3. Site_Code - The site_code for the site where the network equipment is
						 located.  This site_code must match the folder in the input_files
						 directory.
					  4. Cisco L3 Switch IP - Enter the IP of the L3 switch if one exists if not just hit 'Enter'.
						 This option will pull the ARP table from the L3 switch and match MACs to IP addresses and 
						 attempt to perform DNS resolution on the IP address. 

Folder Structure: 
					SWITCHMAPPER (folder)
					-------------->INPUT_FILE (folder)
					|                  ---------->site_code (folder)
					|				             |    --------> ip_list.txt (file)
					--------------><USERNAME> (folder)
					|                |  ---------->SITE_CODE (folder)
					|				                 -------->OUTPUT_FILE1.HTML (file)
					|								 -------->OUTPUT_FILE2.HTML (file)
					|								 -------->OUTPUT_FILE3.HTML (file)
					
					Notes:  The folders and files that are uppercase will be automatically
							generated by the script.  The lowercase folders and files need
							to be manually created by you.

Execution (Assumes A Windows Computer):
				1. Log into <your computer>
				2. Open the folder where the python script is located
				3. Open the input_files folder
				4. Create a folder with the name of the site you are working at
				5. Open the site code folder and create a new text file.  
				6. Add the IP address(es) of the switch(es) one line at a time. See sample_ip_list.txt for reference.
				7. Save the file. You can name it anything, but <site_name>.txt is preferred where site name is the the name of the site (e.g. hq.txt, store1.txt, depot.txt.
				8. Go back to the root folder that holds the folder where your Python script is.
				9. Hold down the SHIFT key and Right-Click on the folder SWITCHMAPPER folder
				10. A context menu will appear and you will see one of the following:
					a. Open Powershell window here
					b. Open Cmd (Commnad) window here
				11. Click the one that appears
				12. You will be presented with a terminal window.  
				13. Type switch_port_mapper.py <text_file> where <text_file> is the name of the file you saved in step 7
				14. Hit Enter
				15. You will be asked for the following inputs:
					a. username
					b. password
					c. site_code - this should be the name of the folder you created in step 4 within the input_files directory
					d. Cisco L3 Switch IP
				16. The script will run:
				    a. If you enter the wrong credentials the script will stop
					b. If the switch is not reachable you will see an error, but the script should continue to process the remaining devices.
				    
					
**************************************************************************************